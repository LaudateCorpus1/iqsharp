##
# Move build artifacts and create conda environment
##

steps:
##
# Pre-reqs
##
- task: DownloadBuildArtifacts@0
  inputs:
    artifactName: iqsharp
    downloadPath: '$(System.DefaultWorkingDirectory)/artifacts'

- pwsh: Move-Item "$Env:SYSTEM_DEFAULTWORKINGDIRECTORY/artifacts/iqsharp/drops" "$Env:SYSTEM_DEFAULTWORKINGDIRECTORY/drops"
  displayName: "Move build artifacts to IQ# working directory"

##
# Create conda environment
##
- script: |
    conda create --yes --quiet --name conda_env
  displayName: Create Anaconda environment
  
- script: |
    conda install --yes --quiet --name conda_env python=3.7 pip setuptools pytest jupyter numpy conda-build=3.18.8 conda-package-handling=1.3.11
  displayName: Install Anaconda packages

- script: |
    echo 'Running this job on $(OperatingSystem)'
  displayName: Print on Linux
  condition: eq(variables.OperatingSystem, 'linux')

- script: |
    echo 'Running this job on $(OperatingSystem)'
  displayName: Print on Mac
  condition: eq(variables.OperatingSystem, 'mac')